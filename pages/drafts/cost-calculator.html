---
layout: breadcrumbs
permalink: /cost-calculator-draft
---
<h1>Upgrade Calculator</h1>
<label for="botSelect">Select a Bot:</label>
<select id="botSelect">
    {% for bot in site.data.bots %}
    <option value="{{ bot.botName }}">{{ bot.botName }}</option>
    {% endfor %}
</select>

<label for="fromLevel">From Level:</label>
<input type="number" id="fromLevel" value="0" min="0" max="29">

<label for="toLevel">To Level:</label>
<input type="number" id="toLevel" value="10" min="1" max="30">

<button id="calculateButton">Calculate Upgrades</button>

<p>
    Base stats version: <span id="bot-stats-version"></span>
    Upgrade data version: <span id="bot-upgrades-version"></span>
</p>

<table id="results-table" border='1' style='border-collapse:collapse'>
    <thead>
        <tr>
            <th>Level</th>
            <th>Sum Epic</th>
            <th>Sum Rare</th>
            <th>Sum Special</th>
            <th>Sum Common 1</th>
            <th>Sum Common 2</th>
            <th>Sum Common 3</th>
            <th>Sum Gold</th>
            <th>End HP</th>
            <th>End Attack</th>
            <th>End DPS</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>

<h2>Results Collection JSON (debug)</h2>
<pre id="results-json"></pre>
<!-- Add upgrade calculator -->
<script src="{{ site.baseurl }}/assets/js/upgrade-calculator.js"></script>

<script>

    document.addEventListener("DOMContentLoaded", function ()
    {
        const botSelectInput = document.getElementById("botSelect");
        const fromLevelInput = document.getElementById("fromLevel");
        const toLevelInput = document.getElementById("toLevel");
        const calculateButton = document.getElementById("calculateButton");
        const resultsJSONElement = document.querySelector("#results-json");
        const statsVersionSpanElement = document.getElementById("bot-stats-version");
        const upgradesVersionSpanElement = document.getElementById("bot-upgrades-version");
        

        calculateButton.addEventListener("click", function ()
        {
            const selectedBotName = botSelectInput.value;
            const selectedBot = getSelectedBot(selectedBotName);

            if (selectedBot)
            {
                const botUpgrades = {{ site.data.botupgrades | jsonify }};
                const upgradesData = botUpgrades.upgradeData;
                const baseStats = selectedBot.baseStats;

                const fromLevel = parseInt(fromLevelInput.value);
                const toLevel = parseInt(toLevelInput.value);

                upgradeResultsCollection = calculateUpgrades(
                    upgradesData,
                    baseStats,
                    fromLevel,
                    toLevel
                    );

            populateTable(upgradeResultsCollection, fromLevel, toLevel);
            resultsJSONElement.textContent = JSON.stringify(upgradeResultsCollection, null, 2);
            statsVersionSpanElement.innerText = baseStats.version;
            upgradesVersionSpanElement.innerText = botUpgrades.version;
            }
        }
    );

    // Function to get the selected bot from the data
    function getSelectedBot(botName) {
    return {{ site.data.bots | jsonify }}.find((bot) => bot.botName === botName);
    }

// Function to populate the table with the resultsCollection data
function populateTable(results, fromLevel, toLevel)
{
    const tableBody = document.querySelector("#results-table tbody");
    tableBody.innerHTML = "";
    results.forEach(result =>
    {
        if (result.level == 0 || (result.level >= fromLevel && result.level <= toLevel)) {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td>${result.level}</td>
            <td>${result.sumEpic}</td>
            <td>${result.sumRare}</td>
            <td>${result.sumSpecial}</td>
            <td>${result.sumCommon1}</td>
            <td>${result.sumCommon2}</td>
            <td>${result.sumCommon3}</td>
            <td>${result.sumGold}</td>
            <td>${result.endHp}</td>
            <td>${result.endAttack}</td>
            <td>${result.endDps}</td>
            `;
            tableBody.appendChild(row);
        }
    });
}
    });
</script>
